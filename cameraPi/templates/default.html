<table class='pin-table'>
{% for pin in pins %}
	<tr>
		<td>
			The {{ pins[pin].name }} is currently
		</td>
		<td>
			<center>
				{% if pins[pin].state == true %}
					<div class='pin-toggle pin-toggle-on' id="{{pin}}">on</div>
				{% else %}
					<div class='pin-toggle' id="{{pin}}">off</div>
				{% endif %}
			</center>
		</td>
	</tr>
{% endfor %}
</table>


<script type=text/javascript>
	$(function() {
		$('div.pin-toggle').bind('click', function() {
			var pin = $(this).attr('id');

			$.ajax({
				type: 'POST',
				url: $SCRIPT_ROOT + 'toggle_pin',
				data: {
					pin: pin,
				},
				error: function(response) {
					console.log(response);
				},
				success: function(response) {
					$.each(response, function (index, value) {
						pin = $('#' + index + '.pin-toggle');

						if (value.state) {
							pin.addClass('pin-toggle-on');
							pin.text('on');
						}
						else {
							pin.removeClass('pin-toggle-on');
							pin.text('off');
						}
					});
				}
			});

		return false;
		});
	});
</script>